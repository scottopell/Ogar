{"version":3,"sources":["modules/log.ts"],"names":["Log","Log.constructor","Log.setup","Log.onConnect","Log.onDisconnect","Log.onCommand","Log.formatTime"],"mappings":";;;;;;;;;;;;kBACoB,IAAI;;IAAZ,EAAE;;oBACQ,MAAM;;IAAhB,IAAI;;kBACE,IAAI;;IAEtB,GAAA;AACEA,aADF,GAAA,GACEA;8BADF,GAAA;KAGGC;;iBAHH,GAAA;;eAKOD,eAACA,UAAUA,EAAAA;AACdE,gBAAIA,CAACA,EAAEA,CAACA,UAAUA,CAACA,QAAQA,CAACA,EAAEA;AAE5BA,kBAAEA,CAACA,KAAKA,CAACA,QAAQA,CAACA,CAACA;aACpBA;AAEDA,oBAAQA,UAAUA,CAACA,MAAMA,CAACA,cAAcA;AACtCA,qBAAKA,CAACA;AACJA,wBAAIA,MAAMA,GAAGA,EAAEA,CAACA,iBAAiBA,CAACA,eAAeA,EAAEA,EAACA,KAAKA,EAAGA,GAAGA,EAACA,CAACA,CAACA;AAGlEA,wBAAIA,CAACA,SAASA,GAAGA,UAASA,EAAEA,EAAAA;AAC1B,8BAAM,CAAC,KAAK,CAAC,GAAG,GAAC,IAAI,CAAC,UAAU,EAAE,GAAC,aAAa,GAAG,EAAE,UAAM,CAAC,CAAC;qBAC9D,CAACA;AAEFA,wBAAIA,CAACA,YAAYA,GAAGA,UAASA,EAAEA,EAAAA;AAC7B,8BAAM,CAAC,KAAK,CAAC,GAAG,GAAC,IAAI,CAAC,UAAU,EAAE,GAAC,gBAAgB,GAAG,EAAE,UAAM,CAAC,CAAC;qBACjE,CAACA;AAAAA,AACJA,qBAAKA,CAACA;AACJA,wBAAIA,WAAWA,GAAGA,EAAEA,CAACA,iBAAiBA,CAACA,oBAAoBA,EAAEA,EAACA,KAAKA,EAAGA,GAAGA,EAACA,CAACA,CAACA;AAE5EA,2BAAOA,CAACA,GAAGA,GAAGA,UAASA,CAACA,EAAAA;AACtB,mCAAW,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,UAAM,CAAC,CAAC;AACxC,+BAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,UAAM,CAAC,CAAC;qBAC5C,CAACA;AAGFA,wBAAIA,CAACA,SAASA,GAAGA,UAASA,OAAOA,EAAAA;AAC/B,mCAAW,CAAC,KAAK,CAAC,GAAG,GAAG,OAAO,UAAM,CAAC,CAAC;qBACxC,CAACA;AAAAA,AACJA,qBAAKA,CAACA;AAEJA,2BAAOA,CAACA,EAAEA,CAACA,mBAAmBA,EAAEA,UAASA,GAAGA,EAAAA;AAC1C,+BAAO,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;qBACxB,CAACA,CAACA;AAAAA,AACLA;AACEA,0BAAMA;AAAAA,aACTA;SACFA;;;eAEQF,mBAACA,EAAEA,EAAAA,EAEXG;;;eAEWH,sBAACA,EAAEA,EAAAA,EAEdI;;;eAEQJ,mBAACA,OAAOA,EAAAA,EAEhBK;;;eAESL,sBAAAA;AACRM,gBAAIA,IAAIA,GAAGA,IAAIA,IAAIA,EAAEA,CAACA;AACtBA,gBAAIA,OAAgBA,CAACA;AAErBA,gBAAIA,IAAIA,GAAGA,IAAIA,CAACA,QAAQA,EAAEA,CAACA;AAC3BA,mBAAOA,GAAGA,CAACA,IAAIA,GAAGA,EAAEA,GAAGA,GAAGA,GAAGA,EAAEA,CAAAA,GAAIA,IAAIA,CAACA;AAExCA,gBAAIA,GAAGA,GAAIA,IAAIA,CAACA,UAAUA,EAAEA,CAACA;AAC7BA,mBAAOA,IAAIA,GAAGA,IAAIA,GAAGA,GAAGA,EAAEA,GAAGA,GAAGA,GAAGA,EAAEA,CAAAA,AAACA,GAAGA,GAAGA,CAACA;AAE7CA,mBAAOA,OAAOA,CAACA;SAChBA;;;WApEH,GAAA;;;qBAAA,GAAA","file":"modules/log.js","sourcesContent":["/// <reference path=\"../../typings/tsd.d.ts\" />\nimport * as fs from 'fs';\nimport * as util from 'util';\nimport {EOL} from 'os';\n\nexport default class Log{\n  constructor(){\n    // empty\n  }\n\n  setup(gameServer) {\n    if (!fs.existsSync('./logs')) {\n      // Make log folder\n      fs.mkdir('./logs');\n    }\n\n    switch (gameServer.config.serverLogLevel) {\n      case 2:\n        var ip_log = fs.createWriteStream('./logs/ip.log', {flags : 'w'});\n\n        // Override\n        this.onConnect = function(ip) {\n          ip_log.write(\"[\"+this.formatTime()+\"] Connect: \" + ip + EOL);\n        };\n\n        this.onDisconnect = function(ip) {\n          ip_log.write(\"[\"+this.formatTime()+\"] Disconnect: \" + ip + EOL);\n        };\n      case 1:\n        var console_log = fs.createWriteStream('./logs/console.log', {flags : 'w'});\n\n        console.log = function(d) { //\n          console_log.write(util.format(d) + EOL);\n          process.stdout.write(util.format(d) + EOL);\n        };\n\n        //\n        this.onCommand = function(command) {\n          console_log.write(\">\" + command + EOL);\n        };\n      case 0:\n        // Prevent crashes\n        process.on('uncaughtException', function(err) {\n          console.log(err.stack);\n        });\n      default:\n        break;\n    }\n  }\n\n  onConnect(ip) {\n    // Nothing\n  }\n\n  onDisconnect(ip) {\n    // Nothing\n  }\n\n  onCommand(command) {\n    // Nothing\n  }\n\n  formatTime() {\n    var date = new Date();\n    var strTime : string;\n\n    var hour = date.getHours();\n    strTime = (hour < 10 ? \"0\" : \"\") + hour;\n\n    var min  = date.getMinutes();\n    strTime += \":\" + (min < 10 ? \"0\" : \"\") + min;\n\n    return strTime;\n  }\n}\n"],"sourceRoot":"/source/"}