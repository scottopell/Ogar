{"version":3,"sources":["modules/ini.ts"],"names":["encode","dotSplit","decode","isQuoted","safe","unsafe"],"mappings":"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","file":"modules/ini.js","sourcesContent":["export {decode as parse, decode};\nexport {encode as stringify, encode};\nexport {safe, unsafe};\n\nvar eol = process.platform === \"win32\" ? \"\\r\\n\" : \"\\n\";\n\nfunction encode (obj, opt) {\n  var children = [],\n  out = \"\";\n\n  if (typeof opt === \"string\") {\n    opt = {\n      section: opt,\n      whitespace: false\n    };\n  } else {\n    opt = opt || {};\n    opt.whitespace = opt.whitespace === true;\n  }\n\n  var separator = \" = \";\n\n  Object.keys(obj).forEach(function (k, _, __) {\n    var val = obj[k];\n    if (val && Array.isArray(val)) {\n      val.forEach(function(item) {\n        out += safe(k + \"[]\") + separator + safe(item) + \"\\n\";\n      });\n    }\n    else if (val && typeof val === \"object\") {\n      children.push(k);\n    } else {\n      out += safe(k) + separator + safe(val) + eol;\n    }\n  });\n\n  if (opt.section && out.length) {\n    out = \"[\" + safe(opt.section) + \"]\" + eol + out;\n  }\n\n  children.forEach(function (k, _, __) {\n    var nk = dotSplit(k).join('\\\\.');\n    var section = (opt.section ? opt.section + \".\" : \"\") + nk;\n    var child = encode(obj[k], {\n    section: section,\n    whitespace: opt.whitespace\n    });\n    if (out.length && child.length) {\n      out += eol;\n    }\n    out += child;\n  });\n\n  return out;\n}\n\nfunction dotSplit (str) {\n  return str.replace(/\\1/g, '\\u0002LITERAL\\\\1LITERAL\\u0002')\n    .replace(/\\\\\\./g, '\\u0001')\n    .split(/\\./).map(function (part) {\n      return part.replace(/\\1/g, '\\\\.')\n        .replace(/\\2LITERAL\\\\1LITERAL\\2/g, '\\u0001');\n    });\n}\n\nfunction decode (str) {\n  var out = {},\n  p = out,\n  state = \"START\",\n  // section     |key = value\n  re = /^\\[([^\\]]*)\\]$|^([^=]+)(=(.*))?$/i,\n  lines = str.split(/[\\r\\n]+/g),\n  section = null;\n\n  lines.forEach(function (line, _, __) {\n    if (!line || line.match(/^\\s*[;#]/)) {\n      return;\n    }\n\n    var match = line.match(re);\n\n    if (!match) {\n      return;\n    }\n\n    if (match[1] !== undefined) {\n      section = unsafe(match[1]);\n      p = out[section] = out[section] || {};\n      return;\n    }\n\n    var key = unsafe(match[2]),\n    value = match[3] ? unsafe((match[4] || \"\")) : true;\n\n    // Convert keys with '[]' suffix to an array\n    if (key.length > 2 && key.slice(-2) === \"[]\") {\n      key = key.substring(0, key.length - 2);\n      if (!p[key]) {\n        p[key] = [];\n      } else if (!Array.isArray(p[key])) {\n        p[key] = [p[key]];\n      }\n    }\n\n    // safeguard against resetting a previously defined\n    // array by accidentally forgetting the brackets\n    if (isInt(value)) {\n      p[key] = parseInt(value);\n    } else {\n      p[key] = parseFloat(value);\n    }\n  });\n\n  // {a:{y:1},\"a.b\":{x:2}} --> {a:{y:1,b:{x:2}}}\n  // use a filter to return the keys that have to be deleted.\n  Object.keys(out).filter(function (k, _, __) {\n    if (!out[k] || typeof out[k] !== \"object\" || Array.isArray(out[k])) return false\n      // see if the parent section is also an object.\n      // if so, add it to that, and mark this one for deletion\n      var parts = dotSplit(k),\n      p = out,\n      l = parts.pop(),\n      nl = l.replace(/\\\\\\./g, '.');\n    parts.forEach(function (part, _, __) {\n      if (!p[part] || typeof p[part] !== \"object\") {\n        p[part] = {};\n      }\n      p = p[part];\n    });\n    if (p === out && nl === l) {\n      return false;\n    }\n    p[nl] = out[k];\n    return true;\n  }).forEach(function (del, _, __) {\n    delete out[del];\n  });\n\n  return out;\n}\n\nfunction isQuoted (val) {\n  return (val.charAt(0) === \"\\\"\" && val.slice(-1) === \"\\\"\")\n    || (val.charAt(0) === \"'\" && val.slice(-1) === \"'\");\n}\n\nfunction safe(val) {\n  return (typeof val !== \"string\"\n      || val.match(/[=\\r\\n]/)\n      || val.match(/^\\[/)\n      || (val.length > 1\n        && isQuoted(val))\n      || val !== val.trim())\n    ? JSON.stringify(val)\n    : val.replace(/;/g, '\\\\;').replace(/#/g, \"\\\\#\");\n}\n\nfunction unsafe(val) {\n  val = (val || \"\").trim();\n  if (isQuoted(val)) {\n    // remove the single quotes before calling JSON.parse\n    if (val.charAt(0) === \"'\") {\n      val = val.substr(1, val.length - 2);\n    }\n    try {\n      val = JSON.parse(val);\n    } catch (_) {}\n  } else {\n    // walk the val to find the first not-escaped ; character\n    var esc = false;\n    var unesc = \"\";\n    for (var i = 0, l = val.length; i < l; i++) {\n      var c = val.charAt(i);\n      if (esc) {\n        if (\"\\\\;#\".indexOf(c) !== -1)\n          unesc += c;\n        else\n          unesc += \"\\\\\" + c;\n        esc = false;\n      } else if (\";#\".indexOf(c) !== -1) {\n        break;\n      } else if (c === \"\\\\\") {\n        esc = true;\n      } else {\n        unesc += c;\n      }\n    }\n    if (esc)\n      unesc += \"\\\\\";\n    return unesc;\n  }\n  return val;\n}\n\nvar isInt = function(n) {\n  return parseInt(n) === n;\n}\n\n"],"sourceRoot":"/source/"}